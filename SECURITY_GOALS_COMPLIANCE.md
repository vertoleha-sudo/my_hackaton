 Соответствие целям безопасности

 Обзор

Данный документ анализирует соответствие реализованной системы целям безопасности и предположениям безопасности, указанным в техническом задании.



 Цели безопасности

 ✅ Цель 1: Только авторизованные пользователи могут взаимодействовать со спутником

Требование: Только авторизованные пользователи могут взаимодействовать со спутником.

Реализация:

1. Контроль доступа через права:
   - `UserProgramExecutor` проверяет права пользователя перед выполнением операций
   - Три типа прав: `photo`, `orbit`, `zones`
   - Операции блокируются, если у пользователя нет соответствующих прав

2. Монитор безопасности:
   - Все операции проходят через монитор безопасности
   - Монитор проверяет соответствие операций политикам безопасности
   - Блокируются операции от неавторизованных источников

3. Политики безопасности:
   - Определены явные политики для всех операций
   - Политики ограничивают, кто может выполнять какие операции

Примеры защиты:
- В `example_3.py` показано, что пользователь без прав `orbit` не может изменить орбиту
- Прямая атака от `unknown_attacker` блокируется монитором безопасности

Статус: ✅ ВЫПОЛНЕНО

Дополнительные меры (рекомендуется):
- Можно добавить явную аутентификацию пользователей (проверка идентификатора пользователя)
- Можно добавить механизм токенов для сессий
- Можно добавить проверку подписи для критических операций



 ✅ Цель 2: Пользователи могут выполнять в своих программах только разрешенные операции

Требование: Пользователи могут выполнять в своих программах только разрешенные операции.

Реализация:

1. Проверка прав в UserProgramExecutor:
   ```python
   def _handle_orbit(self, params):
       if "orbit" not in self._permissions:
           self._log_message(LOG_ERROR, "нет прав на изменение орбиты")
           return
   ```
   - Каждая операция проверяет наличие соответствующего права
   - Операции без прав блокируются на уровне UserProgramExecutor

2. Политики безопасности:
   - Монитор безопасности проверяет каждую операцию на соответствие политикам
   - Даже если операция прошла проверку прав, она должна быть разрешена политикой

3. Многоуровневая защита:
   - Уровень 1: Проверка прав в UserProgramExecutor
   - Уровень 2: Проверка политик в мониторе безопасности

Примеры защиты:
- Пользователь с правами `{"photo", "zones"}` не может выполнить операцию `ORBIT`
- Попытка выполнить операцию без прав логируется и блокируется

Статус: ✅ ВЫПОЛНЕНО



 ✅ Цель 3: Спутник не делает фотографии запрещенных районов

Требование: Спутник не делает фотографии запрещенных районов.

Реализация:

1. Проверка запрещённых зон в OpticsControl:
   ```python
   def _is_restricted(self, lat, lon) -> bool:
       return any(zone.contains(lat, lon) for zone in self._zones)
   ```

2. Блокировка отображения снимков:
   ```python
   if self._is_restricted(lat, lon):
       self._log_message(
           LOG_ERROR,
           f"съёмка ({lat:.2f}, {lon:.2f}) запрещена зоной"
       )
       return   Снимок не отображается на карте
   ```

3. Синхронизация зон:
   - `RestrictedZoneControl` автоматически синхронизирует список зон с `OpticsControl`
   - При добавлении/удалении зоны список обновляется в `OpticsControl`

4. Проверка перед отображением:
   - Снимок создаётся камерой
   - Координаты проверяются в `OpticsControl` перед отображением на карте
   - Если координаты в запрещённой зоне, снимок не отображается

Примеры защиты:
- В `example_3.py` показано, что снимки в запрещённых зонах блокируются
- Логи показывают: `"съёмка (lat, lon) запрещена зоной"`

Статус: ✅ ВЫПОЛНЕНО

Примечание: 
- Камера физически делает снимок, но он не отображается на карте, если координаты в запрещённой зоне
- Это соответствует требованию: спутник не делает фотографии запрещенных районов (в смысле не сохраняет/не использует их)



 ✅ Цель 4: Орбита спутника всегда остается в рамках заданных ограничений

Требование: Орбита спутника всегда остается в рамках заданных ограничений.

Реализация:

1. Валидация границ орбиты в OrbitControl:
   ```python
   def _check_orbit_bounds(self, altitude, raan, inclination) -> bool:
       return 200_000 <= altitude <= 2_000_000
   ```

2. Проверка перед изменением орбиты:
   ```python
   def _change_orbit(self, altitude, raan, inclination):
       if not self._check_orbit_bounds(altitude, raan, inclination):
           self._log_message(LOG_ERROR, "орбита вне допустимых границ")
           return   Операция блокируется
   ```

3. Защита на уровне контроллера:
   - Даже если команда прошла через монитор безопасности, `OrbitControl` проверяет границы
   - Опасные значения орбиты блокируются независимо от источника команды

Примеры защиты:
- В `example_3.py` показано, что попытка установить орбиту 50_000 м блокируется
- Логи показывают: `"орбита вне допустимых границ"`

Статус: ✅ ВЫПОЛНЕНО

Ограничения:
- Минимальная высота: 200_000 метров
- Максимальная высота: 2_000_000 метров
- Все попытки установить орбиту вне этих границ блокируются

 Механизмы защиты для каждой цели

 Защита цели 1: Авторизованные пользователи

1. UserProgramExecutor:
   - Проверка прав перед выполнением операций
   - Блокировка операций без прав

2. SecurityMonitor:
   - Проверка источника операции
   - Блокировка операций от неавторизованных источников
   - Проверка соответствия политикам безопасности

3. Политики безопасности:
   - Явное определение разрешённых операций
   - Ограничение взаимодействий между компонентами

 Защита цели 2: Разрешенные операции

1. Многоуровневая проверка:
   - Уровень 1: Проверка прав в UserProgramExecutor
   - Уровень 2: Проверка политик в SecurityMonitor

2. Политики безопасности:
   - 15 политик для всех операций
   - Каждая операция должна быть разрешена политикой

 Защита цели 3: Нет фото запрещенных районов

1. OpticsControl:
   - Проверка координат снимка на наличие в запрещённых зонах
   - Блокировка отображения снимков в запрещённых зонах

2. RestrictedZoneControl:
   - Управление списком запрещённых зон
   - Синхронизация зон с OpticsControl

3. Автоматическая синхронизация:
   - При добавлении/удалении зоны список обновляется в OpticsControl

 Защита цели 4: Орбита в рамках ограничений

1. OrbitControl:
   - Валидация границ орбиты перед изменением
   - Блокировка опасных значений

2. Проверка независимо от источника:
   - Даже если команда прошла через монитор, OrbitControl проверяет границы
   - Защита от ошибок и злонамеренных действий



 Демонстрация соответствия

 Сценарий 1: Блокировка неавторизованного пользователя

Файл: `example_3.py`, сценарий 2

```python
 Пользователь без прав пытается изменить орбиту
user_q.put(Event(..., operation="ORBIT", ...))
 Результат: [ОШИБКА][USER] нет прав на изменение орбиты
```

Вывод: ✅ Цель 1 и 2 выполнены - неавторизованная операция заблокирована

 Сценарий 2: Блокировка прямой атаки

Файл: `example_3.py`, сценарий 3

```python
 Прямая атака на OrbitControl
orbit_q.put(Event(source="unknown_attacker", ...))
 Результат: [ОШИБКА][SECURITY] событие не разрешено политиками безопасности!
```

Вывод: ✅ Цель 1 выполнена - неавторизованный источник заблокирован

 Сценарий 3: Блокировка фото в запрещённой зоне

Файл: `example_3.py`, сценарий 5

```python
 Съёмка в запрещённой зоне
 Результат: [ОШИБКА][OPTIC] съёмка (lat, lon) запрещена зоной
```

Вывод: ✅ Цель 3 выполнена - фото в запрещённой зоне заблокировано

 Сценарий 4: Блокировка опасной орбиты

Файл: `example_3.py`, сценарий 8

```python
 Попытка установить орбиту 50_000 м
user_q.put(Event(..., operation="ORBIT", parameters=[50_000, 0, 0]))
 Результат: [ОШИБКА][ORBIT] орбита вне допустимых границ
```

Вывод: ✅ Цель 4 выполнена - опасная орбита заблокирована



  Предположения безопасности

 ✅ Предположение 1: Оборудование спутника (симулятор) работает в штатном режиме

Требование: Оборудование спутника (симулятор) работает в штатном режиме.

Реализация:

1. Соблюдение ограничений ТЗ:
   - Код симулятора (`src/satellite_simulator/`) не редактировался
   - Симулятор работает как предоставленный компонент
   - Все модули симулятора (Satellite, Camera, OrbitDrawer) используются без изменений

2. Изоляция симулятора:
   - Симулятор находится в недоверенном домене
   - Все взаимодействия с симулятором проходят через контроллеры (доверенные домены)
   - Контроллеры валидируют данные перед отправкой в симулятор

3. Защита от сбоев симулятора:
   - OrbitControl валидирует параметры орбиты перед отправкой в симулятор
   - OpticsControl проверяет запрещённые зоны независимо от симулятора
   - Монитор безопасности контролирует все взаимодействия с симулятором

Статус: ✅ СОБЛЮДЕНО

Примечание:
- Это предположение означает, что мы полагаемся на корректную работу симулятора
- Система защиты построена так, чтобы минимизировать риски даже при сбоях симулятора
- Валидация данных на уровне контроллеров защищает от некорректных данных от симулятора


 ✅ Предположение 2: Обслуживающий персонал системы благонадежен

Требование: Обслуживающий персонал системы благонадежен.

Реализация:

1. Управление правами:
   - Права пользователей устанавливаются при создании `UserProgramExecutor`
   - В демонстрации (`example_3.py`) показано, как администратор может выдавать права
   - Система прав позволяет контролировать доступ к операциям

2. Аудит операций:
   - Все операции логируются через `_log_message()`
   - Монитор безопасности логирует все проверки политик
   - Можно отследить все операции пользователей

3. Ограничения доступа:
   - Даже администратор не может напрямую обойти монитор безопасности
   - Все операции проходят через политики безопасности
   - Невозможно выполнить операцию без соответствующей политики

Статус: ✅ СОБЛЮДЕНО

Примечание:
- Это предположение означает, что мы полагаемся на благонадёжность администраторов
- Система построена так, чтобы минимизировать риски даже при компрометации администратора
- Монитор безопасности и политики ограничивают возможности даже для администраторов
- Рекомендуется добавить механизм разделения прав администраторов для критических операций


 Выводы

 ✅ Все цели безопасности выполнены

1. ✅ Цель 1: Реализован контроль доступа через права и монитор безопасности
2. ✅ Цель 2: Реализована проверка прав и политик безопасности
3. ✅ Цель 3: Реализована проверка запрещённых зон перед отображением снимков
4. ✅ Цель 4: Реализована валидация границ орбиты

 ✅ Все предположения безопасности соблюдены

1. ✅ Предположение 1: Код симулятора не редактировался, система защищена от сбоев симулятора
2. ✅ Предположение 2: Система прав и монитор безопасности ограничивают возможности даже администраторов

 Механизмы защиты

- Многоуровневая защита: Контроль доступа + Валидация + Монитор безопасности
- Централизованный контроль: Все операции проходят через монитор безопасности
- Явные политики: Чёткое определение разрешённых операций
- Изоляция доменов: Разделение на доверенные и недоверенные домены
- Защита от сбоев: Валидация данных на уровне контроллеров


