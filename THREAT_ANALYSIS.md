 Анализ угроз и негативных сценариев

 Обзор

Данный документ описывает анализ угроз для кибериммунной системы управления спутником и моделирование негативных сценариев, которые система должна предотвращать.

 Цели безопасности (ЦБ)

1. Целостность данных: Защита высокоцелостных данных (параметры орбиты, координаты запрещённых зон) от несанкционированного изменения
2. Конфиденциальность: Предотвращение съёмки в запрещённых зонах
3. Доступность: Обеспечение работоспособности системы при компрометации отдельных компонентов
4. Контроль доступа: Ограничение прав пользователей согласно их разрешениям

 Классификация доменов

 Доверенные домены (Trusted Domains)
- OrbitControl: Управление параметрами орбиты (высокоцелостные данные)
- RestrictedZoneControl: Управление запрещёнными зонами (высокоцелостные данные)
- OpticsControl: Контроль съёмки с проверкой запрещённых зон
- SecurityMonitor: Монитор безопасности (критический компонент)

 Недоверенные домены (Untrusted Domains)
- UserProgramExecutor: Исполнитель пользовательских программ
- Satellite: Симулятор спутника
- Camera: Симулятор камеры
- OrbitDrawer: Визуализация данных

 Анализ угроз

 Угроза 1: Компрометация UserProgramExecutor

Сценарий: Злоумышленник получает контроль над UserProgramExecutor и пытается обойти ограничения прав.

Атаки:
1. Попытка изменить орбиту без прав `orbit`
2. Попытка сделать снимок без прав `photo`
3. Попытка изменить зоны без прав `zones`
4. Прямая отправка команд в обход UserProgramExecutor

Защита:
- ✅ Проверка прав в UserProgramExecutor перед отправкой команды
- ✅ Монитор безопасности проверяет все операции на соответствие политикам
- ✅ Прямые команды от неизвестных источников блокируются монитором

Негативный сценарий: Если UserProgramExecutor скомпрометирован, но у пользователя нет прав, система должна блокировать операции. Монитор безопасности предотвращает обход проверки прав.

 Угроза 2: Компрометация RestrictedZoneControl

Сценарий: RestrictedZoneControl скомпрометирован и пытается:
1. Удалить все запрещённые зоны
2. Добавить поддельные зоны
3. Отправить неверные данные в OpticsControl

Защита:
- ✅ Все операции RestrictedZoneControl проходят через монитор безопасности
- ✅ Политики безопасности ограничивают, кто может взаимодействовать с RestrictedZoneControl
- ✅ OpticsControl получает синхронизированные данные о зонах только от RestrictedZoneControl

Негативный сценарий: Если RestrictedZoneControl скомпрометирован, он может изменить зоны, но:
- Монитор безопасности проверяет источник операций
- Только авторизованные источники (user_program с правами zones) могут добавлять/удалять зоны
- Операции от скомпрометированного RestrictedZoneControl к OpticsControl разрешены политиками, но это ожидаемое поведение для синхронизации зон

Рекомендация: В будущем можно добавить цифровую подпись для операций изменения зон.

 Угроза 3: Компрометация OrbitControl

Сценарий: OrbitControl скомпрометирован и пытается:
1. Установить опасную орбиту (слишком низкую или высокую)
2. Отправить неверные команды спутнику

Защита:
- ✅ OrbitControl проверяет границы орбиты (200_000 - 2_000_000 метров)
- ✅ Все операции проходят через монитор безопасности
- ✅ Только авторизованные источники могут отправлять команды изменения орбиты

Негативный сценарий: Если OrbitControl скомпрометирован, он может попытаться установить опасную орбиту, но:
- Валидация границ орбиты предотвращает опасные значения
- Монитор безопасности проверяет источник команды

Демонстрация: В example_3.py показан сценарий, где пользователь пытается установить опасно низкую орбиту (50_000 м), что блокируется OrbitControl.

 Угроза 4: Обход монитора безопасности

Сценарий: Компонент пытается отправить команду напрямую, минуя монитор безопасности.

Атаки:
1. Прямая отправка в очередь получателя
2. Подмена источника события
3. Использование неавторизованной операции

Защита:
- ✅ Все компоненты отправляют события через монитор безопасности
- ✅ Монитор проверяет каждое событие на соответствие политикам
- ✅ События от неизвестных источников блокируются

Негативный сценарий: В example_3.py показан сценарий, где атакующий пытается отправить команду изменения орбиты напрямую. Монитор безопасности блокирует операцию, так как источник "unknown_attacker" не авторизован.

 Угроза 5: Съёмка в запрещённой зоне

Сценарий: Попытка сделать снимок в запрещённой зоне.

Защита:
- ✅ OpticsControl проверяет координаты снимка перед отображением на карте
- ✅ RestrictedZoneControl синхронизирует список зон с OpticsControl
- ✅ Если координаты попадают в запрещённую зону, снимок не отображается

Негативный сценарий: Если Camera скомпрометирована и пытается сделать снимок в запрещённой зоне, OpticsControl блокирует отображение снимка на карте.

 Угроза 6: Компрометация монитора безопасности

Сценарий: Монитор безопасности скомпрометирован.

Последствия: Критическая угроза - монитор является центральным компонентом безопасности.

Защита:
- ⚠️ Монитор безопасности должен быть изолирован и защищён на уровне операционной системы
- ⚠️ Политики безопасности должны храниться в защищённом хранилище
- ⚠️ Рекомендуется добавить механизм аудита для отслеживания всех операций монитора

Рекомендация: В будущем можно реализовать:
- Цифровые подписи для политик безопасности
- Механизм ротации политик
- Логирование всех операций монитора в защищённое хранилище

 Моделирование негативных сценариев

 Сценарий 1: Пользователь без прав пытается изменить орбиту

Шаги:
1. Пользователь отправляет команду `ORBIT [500_000, 0, 0]`
2. UserProgramExecutor проверяет права - прав нет
3. Операция блокируется, команда не отправляется

Результат: ✅ Операция заблокирована на уровне UserProgramExecutor

 Сценарий 2: Прямая атака на OrbitControl

Шаги:
1. Атакующий отправляет событие напрямую в очередь OrbitControl
2. Монитор безопасности перехватывает событие
3. Монитор проверяет политики - источник не авторизован
4. Операция блокируется

Результат: ✅ Операция заблокирована монитором безопасности

 Сценарий 3: Попытка установить опасную орбиту

Шаги:
1. Пользователь с правами отправляет команду `ORBIT [50_000, 0, 0]` (слишком низкая)
2. UserProgramExecutor пропускает команду (есть права)
3. Монитор безопасности пропускает команду (политика разрешает)
4. OrbitControl проверяет границы орбиты
5. Операция блокируется (орбита вне допустимых границ)

Результат: ✅ Операция заблокирована на уровне OrbitControl

 Сценарий 4: Съёмка в запрещённой зоне

Шаги:
1. Пользователь запрашивает снимок
2. Camera делает снимок и отправляет координаты в OpticsControl
3. OpticsControl проверяет координаты на наличие в запрещённых зонах
4. Если координаты в зоне - снимок не отображается на карте

Результат: ✅ Снимок заблокирован OpticsControl

 Сценарий 5: Компрометация RestrictedZoneControl

Шаги:
1. RestrictedZoneControl скомпрометирован
2. Злоумышленник пытается удалить все зоны
3. Операции проходят через монитор безопасности
4. Монитор проверяет источник - операции от RestrictedZoneControl разрешены для синхронизации с OpticsControl

Проблема: Если RestrictedZoneControl скомпрометирован, он может изменить зоны, так как это его основная функция.

Рекомендация: 
- Добавить механизм аудита для отслеживания изменений зон
- Реализовать механизм отката изменений
- Добавить цифровую подпись для критических операций

 Выводы

Система реализует следующие меры защиты:

1. ✅ Монитор безопасности: Все взаимодействия проходят через монитор, который проверяет соответствие политикам
2. ✅ Контроль доступа: UserProgramExecutor проверяет права пользователя перед выполнением операций
3. ✅ Валидация данных: OrbitControl проверяет границы орбиты
4. ✅ Проверка зон: OpticsControl проверяет координаты снимков на наличие в запрещённых зонах
5. ✅ Изоляция доменов: Разделение на доверенные и недоверенные домены

Рекомендации по улучшению:

1. Добавить цифровые подписи для критических операций
2. Реализовать механизм аудита всех операций
3. Добавить механизм отката изменений для критических данных
4. Реализовать механизм обнаружения аномалий в поведении компонентов
5. Добавить механизм изоляции скомпрометированных компонентов


